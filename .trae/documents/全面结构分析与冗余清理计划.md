## 目标
- 将当前仓库调整为常规 Flutter 插件项目结构（插件 + example），同时完成冗余代码与未使用依赖的清理，使功能与 `/e:/flutter_battery/README.md` 保持一致且通过静态分析与测试验证。

## 结构调整
- 将 `app/` 迁移为标准 `example/`：
  - 重命名目录为 `example/`，保留现有 `lib/`、`integration_test/`、`analysis_options.yaml`、`pubspec.yaml` 与 `android/`
  - 在 `example/pubspec.yaml` 中将对插件的依赖改为 `path: ../`（当前已是 `../flutter_battery`，迁移后改为 `../`）
  - 保持示例 UI 与 `BatterySubsystemRepository` 使用插件 API 的方式不变
- IoT 原生库 `android-iot-native/`：
  - 若示例仍需原生事件演示，将其迁移为 `example/android/` 下的子模块（`settings.gradle.kts` 引入 `:android-iot-native`）
  - 如示例不再依赖该库，可在清理阶段移除以简化仓库（保留方案二作为回退）

## 插件与原生实现修正
- 修正插件自动注册：`android/src/main/resources/META-INF/services/io.flutter.embedding.engine.plugins.FlutterPlugin` 内容更新为 `com.example.flutter_battery.FlutterBatteryPlugin`
- 清理未用/重复原生代码与资源：
  - 删除 `push_notification` 下未接入的演示与服务代码：`api/`、`data/`、`di/`、`domain/`、`presentation/`、重复的 `push_notification/` 子目录与 `service/MyFirebaseMessagingService.kt` 两份、占位 `MainActivity.kt`
  - 删除 `android/src/test/kotlin/.../FlutterAssistantPluginTest.kt`
  - 删除 `android/src/main/res/layout/activity_main.xml` 与 `values/strings.xml`（插件非 UI）
- 最小化 Android 依赖（`android/build.gradle`）：保留 `androidx.core:core-ktx` 与 Kotlin 基础；移除 `firebase-messaging`、`io.insert-koin:*`、`constraintlayout`、`lifecycle-*`、`viewmodel-ktx`，去重重复依赖
- 逻辑微修：
  - 修复 `BatteryMonitor.pushBatteryLevel()` 防抖比较逻辑为“上次已推送值 vs 当前值”
  - 移除 `NotificationHelper` 未使用的 `permissionResultListener` 字段（保留现有权限结果处理路径）
- Dart 层：移除 `lib/battery_animation.dart` 未使用的 `dart:math` 导入

## 文档同步
- 更新根 `README.md` 的“项目结构”说明为标准插件结构（`lib/` + `android/` + `example/`），推送模块仅保留 `PushNotificationManager` 与 `NotificationAlarmReceiver`
- 标注移除 Firebase/Koin 不影响插件功能；保留 README 的 API 与调用链图示（MethodChannel/EventChannel）不变

## 验证流程
- 依赖与静态分析：在根与 `example/` 运行 `flutter pub get`、`flutter analyze`
- 单元测试：运行 `flutter test`（根与 `example/`）确保全部通过
- Android 构建：运行 `./gradlew :android:assemble`（以及如保留 IoT 子模块则在 `example/android/` 构建）
- 示例手测：
  - 主动查询与 `batteryInfoStream` 推送正常
  - `configureBattery()` 合并配置与低电量监控触发系统通知/Flutter UI 回调
  - 即时与延迟通知通过 `NotificationAlarmReceiver` 正常

## 风险与回退
- 删除未接入的 Firebase/Koin 仅影响演示代码；如后续需要可在 `example/` 下单独引入
- 插件注册文件修正提升自动注册稳定性；暂无行为兼容性风险

## 交付
- 调整后的目录结构、清理与修复后的代码、更新的 `android/build.gradle` 与 README，验证报告（静态分析零冗余、测试通过）